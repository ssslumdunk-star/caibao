# 美股财报日历功能使用指南

## 🎯 功能概览

您的项目现在已经添加了完整的**美股财报日历**功能！这个功能包括：

- 📅 **交互式财报日历**：以日历形式展示未来和过去的财报发布日期
- 📊 **分析师评论汇总**：点击任何财报事件即可查看全网分析师评论
- 🚀 **实时数据抓取**：从雅虎财经等数据源获取最新财报信息
- 💡 **智能数据展示**：包含EPS预期、实际结果、分析师目标价等

## 🚀 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 启动演示版本（推荐）
```bash
python3 demo_earnings_server.py
```
然后访问：http://localhost:5001

### 3. 启动实际版本（需要稳定网络）
```bash
python3 earnings_web_server.py
```
然后访问：http://localhost:5000

## 📁 新增文件说明

### 核心模块

1. **`earnings_calendar.py`** - 财报日历核心类
   - `EarningsCalendar` 类提供完整的财报数据管理
   - 支持从多个数据源获取财报日期
   - 提供数据缓存和持久化功能

2. **`yahoo_earnings_api.py`** - 雅虎财经API专用模块
   - 优化的雅虎财经数据抓取
   - 包含请求限制和重试机制
   - 专门处理财报日期和分析师数据

3. **`earnings_web_server.py`** - Web服务器（实际数据）
   - Flask Web应用
   - 提供REST API接口
   - 实时获取雅虎财经数据

4. **`demo_earnings_server.py`** - 演示服务器（模拟数据）
   - 使用模拟数据展示所有功能
   - 避免API限制问题
   - 完美展示用户界面和交互

### 测试和工具

5. **`test_earnings_calendar.py`** - 完整功能测试脚本
   - 测试所有核心功能
   - 提供详细的测试报告
   - 包含错误处理测试

## 🎨 功能特点

### 📅 日历界面
- **现代化设计**：响应式界面，支持桌面和移动设备
- **颜色编码**：不同类型的财报事件使用不同颜色
  - 🟢 盘前发布 (BMO - Before Market Open)
  - 🔴 盘后发布 (AMC - After Market Close)
  - 🔵 盘中发布 (During Market Hours)
- **直观导航**：月份切换，快速跳转到指定日期

### 📊 财报详情
点击任何财报事件可查看：
- **基本信息**：公司名称、财报日期、季度、财政年度
- **EPS数据**：预期EPS、实际EPS（如有）、是否超预期
- **营收数据**：预期营收、实际营收（如有）
- **分析师数据**：当前价格、目标价区间、推荐评级

### 💬 分析师评论
- **多数据源**：汇总来自Yahoo Finance、Seeking Alpha、MarketWatch等
- **评级信息**：买入/持有/卖出建议
- **目标价格**：分析师给出的价格目标
- **时间排序**：按发布时间排序，最新评论优先

## 🛠 技术架构

### 数据源
- **主要数据源**：雅虎财经（Yahoo Finance）- 稳定性高
- **辅助数据源**：Seeking Alpha、MarketWatch
- **数据缓存**：本地缓存避免重复请求

### 后端技术
- **Flask**：轻量级Web框架
- **BeautifulSoup**：网页内容解析
- **Requests**：HTTP请求处理
- **Pandas**：数据处理和分析

### 前端技术
- **HTML5 + CSS3**：现代化界面设计
- **JavaScript**：交互功能和AJAX调用
- **响应式设计**：适配各种设备

## 📱 使用示例

### 1. 查看月度财报日历
1. 访问主页，查看当前月份的财报事件
2. 使用"上月/下月"按钮切换月份
3. 今天的日期会用蓝色高亮显示

### 2. 获取财报详情
1. 点击任何财报事件（绿色/红色小框）
2. 弹出详情窗口显示完整信息
3. 查看分析师评论和推荐

### 3. API调用示例
```bash
# 获取财报日历
curl "http://localhost:5001/api/earnings_calendar?start_date=2024-01-01&end_date=2024-01-31"

# 获取特定股票财报详情
curl "http://localhost:5001/api/earnings_details?symbol=AAPL&date=2024-01-25"
```

## 🔧 配置选项

### config.py 中的相关设置
```python
# 请求延迟设置（避免被限制）
MIN_DELAY = 1
MAX_DELAY = 3

# 重试次数
MAX_RETRIES = 3

# 数据存储目录
DATA_DIR = 'data'
```

### 自定义股票列表
在 `DEFAULT_TICKERS` 中添加您关注的股票：
```python
DEFAULT_TICKERS = [
    'AAPL', 'MSFT', 'GOOGL', 'AMZN', 'META', 'TSLA', 'NVDA',
    # 添加您的股票代码
]
```

## 🚨 注意事项

### 网络请求限制
- 雅虎财经对请求频率有限制
- 建议使用演示版本进行功能测试
- 实际使用时请注意请求间隔

### 数据准确性
- 数据来源于公开财经网站
- 建议与官方财报进行比对
- 仅供投资参考，不构成投资建议

### 系统要求
- Python 3.7+
- 稳定的网络连接
- 至少 100MB 可用存储空间

## 📈 扩展建议

### 短期改进
- [ ] 添加更多财经数据源
- [ ] 实现财报提醒功能
- [ ] 支持导出财报数据到Excel
- [ ] 添加财报预测准确率统计

### 长期规划
- [ ] 集成机器学习预测模型
- [ ] 添加实时股价数据
- [ ] 支持组合管理功能
- [ ] 开发移动端应用

## 🐛 故障排除

### 常见问题

**Q: 无法获取财报数据**
A: 检查网络连接，尝试使用演示版本。如果问题持续，可能是API限制导致。

**Q: 页面加载缓慢**
A: 由于需要实时获取数据，首次加载可能较慢。后续会使用缓存加速。

**Q: 分析师评论为空**
A: 某些股票可能没有足够的分析师覆盖，这是正常现象。

### 调试模式
```bash
# 运行测试脚本检查所有功能
python3 test_earnings_calendar.py

# 查看详细日志
tail -f us_stock_filing_scraper.log
```

## 📞 技术支持

如果您在使用过程中遇到问题，请：

1. 首先运行测试脚本确认环境
2. 查看日志文件了解错误详情
3. 尝试使用演示版本排除网络问题

## 🎉 总结

恭喜！您的美股财报抓取工具现在拥有了完整的**财报日历功能**：

✅ **可视化日历界面** - 直观查看所有财报发布日期  
✅ **实时数据抓取** - 从雅虎财经获取最新财报信息  
✅ **分析师评论汇总** - 一键获取全网分析师观点  
✅ **完整的Web界面** - 现代化、响应式设计  
✅ **演示和实际两个版本** - 满足不同使用场景  

现在您可以：
- 📅 通过日历形式查看即将到来的财报发布
- 📊 点击查看详细的财报预期和分析师评论
- 💡 获得投资决策的重要参考信息

立即访问 http://localhost:5001 开始体验！